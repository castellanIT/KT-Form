<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Transfer (KT) Form - Employee Exit Process v2.1</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- AWS SDK CDN -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1691.0.min.js"></script>
    <!-- For Amplify: set your API Gateway proxy URL so the form can reach the webhook (avoids CORS). Uncomment and replace with your URL. -->
    <!-- <script>window.KT_FORM_WEBHOOK_PROXY = 'https://YOUR_API_ID.execute-api.YOUR_REGION.amazonaws.com/prod/make-proxy';</script> -->
    <!-- AWS Configuration (SECURE) -->
    <script src="config.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Knowledge Transfer (KT) Form - Employee Exit Process</h1>
            <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin: 10px 0; text-align: center; font-size: 14px; color: #1976d2;">
                <strong>Version 2.1</strong> - Enhanced with improved contact and access management
            </div>
        </header>

        <form id="ktForm" class="kt-form">
            <!-- Section 1: Employee Details -->
            <section class="form-section">
                <h2>Section 1: Employee Details</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employeeName">Employee Name *</label>
                        <input type="text" id="employeeName" name="employeeName" required>
                    </div>
                    <div class="form-group">
                        <label for="designation">Designation / Role *</label>
                        <input type="text" id="designation" name="designation" required>
                    </div>
                    <div class="form-group">
                        <label for="department">Department / Team *</label>
                        <input type="text" id="department" name="department" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="reportingManagerName">Reporting Manager Name *</label>
                        <input type="text" id="reportingManagerName" name="reportingManagerName" required>
                    </div>
                    <div class="form-group">
                        <label for="reportingManagerEmail">Reporting Manager Email *</label>
                        <input type="email" id="reportingManagerEmail" name="reportingManagerEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="employeeId">Employee ID (if applicable)</label>
                        <input type="text" id="employeeId" name="employeeId">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="dateOfJoining">Date of Joining *</label>
                        <input type="date" id="dateOfJoining" name="dateOfJoining" required>
                    </div>
                    <div class="form-group">
                        <label for="lastWorkingDay">Last Working Day *</label>
                        <input type="date" id="lastWorkingDay" name="lastWorkingDay" required>
                    </div>
                    <div class="form-group">
                        <!-- Empty div for spacing -->
                    </div>
                </div>
            </section>

            <!-- Section 2: Knowledge Transfer Overview -->
            <section class="form-section">
                <h2>Section 2: Knowledge Transfer Overview</h2>
                <div class="form-group">
                    <label for="currentResponsibilities">Current Responsibilities *</label>
                    <textarea id="currentResponsibilities" name="currentResponsibilities" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="ongoingProjects">Ongoing Projects / Tasks *</label>
                    <textarea id="ongoingProjects" name="ongoingProjects" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="toolsSystems">Tools / Systems Used *</label>
                    <textarea id="toolsSystems" name="toolsSystems" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="keyDocuments">Key Documents / Files Location *</label>
                    <textarea id="keyDocuments" name="keyDocuments" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="sops">Standard Operating Procedures (SOPs) *</label>
                    <textarea id="sops" name="sops" rows="4" required></textarea>
                </div>
            </section>

            <!-- Section 3: Key Contacts -->
            <section class="form-section">
                <h2>Section 3: Key Contacts</h2>
                <div class="contacts-container">
                    <div class="contact-header">
                        <div class="contact-field">Name</div>
                        <div class="contact-field">Contact Email</div>
                        <div class="contact-field">Actions</div>
                    </div>
                    <div id="contactsList">
                        <div class="contact-row">
                            <input type="text" name="contactName[]" placeholder="Full Name" class="large-input" required>
                            <input type="email" name="contactEmail[]" placeholder="email@example.com" class="large-input" required>
                            <button type="button" class="remove-contact" onclick="removeContact(this)">Remove</button>
                        </div>
                    </div>
                    <button type="button" id="addContact" class="add-contact-btn">Add Contact</button>
                </div>
            </section>

            <!-- Section 4: Handover Details -->
            <section class="form-section">
                <h2>Section 4: Handover Details</h2>
                <div class="form-group">
                    <label for="successor">Successor / Replacement (if identified)</label>
                    <input type="text" id="successor" name="successor">
                </div>
                <div class="form-group">
                    <label for="areasHandedOver">Areas Fully Handed Over *</label>
                    <textarea id="areasHandedOver" name="areasHandedOver" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="areasPending">Areas Pending (with reason) *</label>
                    <textarea id="areasPending" name="areasPending" rows="4" required></textarea>
                </div>
            </section>

            <!-- Section 5: Access & Credentials -->
            <section class="form-section">
                <h2>Section 5: Access & Credentials</h2>
                <div class="access-container">
                    <div class="access-header">
                        <div class="access-field">Access & Credentials</div>
                        <div class="access-field">Action Required</div>
                        <div class="access-field">Actions</div>
                    </div>
                    <div id="accessList">
                        <div class="access-row">
                            <textarea name="accessCredentials[]" placeholder="Describe the access and credentials (e.g., System: Company Email, Username: john.doe@company.com, Access Level: Admin)" rows="3" required></textarea>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="accessAction_initial" value="Transfer" required>
                                    <span class="radio-text">Transfer</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="accessAction_initial" value="Deactivate" required>
                                    <span class="radio-text">Deactivate</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="accessAction_initial" value="Transfer and Deactivate" required>
                                    <span class="radio-text">Transfer and Deactivate</span>
                                </label>
                            </div>
                            <button type="button" class="remove-access" onclick="removeAccess(this)">Remove</button>
                        </div>
                    </div>
                    <button type="button" id="addAccess" class="add-access-btn">Add Access</button>
                </div>
            </section>

            <!-- Attachments Section -->
            <section class="form-section">
                <h2>Attachments (if any)</h2>
                <div class="form-group">
                    <label for="attachments">Upload Supporting Documents</label>
                    <input type="file" id="attachments" name="attachments" multiple accept=".pdf,.doc,.docx,.txt,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png">
                    <small>Supported formats: PDF, DOC, DOCX, TXT, XLS, XLSX, PPT, PPTX, JPG, JPEG, PNG<br>
                    <strong>File size limit: 5MB per file</strong></small>
                    <div id="fileList" class="file-list"></div>
                </div>
            </section>

            <!-- Section 6: Digital Signatures -->
            <section class="form-section">
                <h2>Section 6: Digital Signatures</h2>
                
                <!-- Employee Signature -->
                <div class="signature-group">
                    <h3>Employee Signature</h3>
                    <div class="signature-container">
                        <canvas id="employeeSignature" class="signature-canvas"></canvas>
                        <div class="signature-controls">
                            <button type="button" id="clearEmployeeSignature" class="clear-signature">Clear Signature</button>
                        </div>
                    </div>
                    <div class="signature-info">
                        <label for="employeeSignatureDate">Date:</label>
                        <input type="date" id="employeeSignatureDate" name="employeeSignatureDate" required>
                    </div>
                </div>

            </section>

            <!-- Submit Button -->
            <div class="form-actions">
                <button type="submit" class="submit-btn">Submit Knowledge Transfer Form</button>
            </div>
        </form>

        <!-- Success Message -->
        <div id="successMessage" class="success-message" style="display: none;">
            <div class="success-container">
                <div class="success-icon">✅</div>
                <h2>Knowledge Transfer Form Submitted Successfully!</h2>
                <div class="success-details">
                    <div class="success-item">
                        <span class="success-label">Form Status:</span>
                        <span class="success-value">Submitted</span>
                    </div>
                    <div class="success-item">
                        <span class="success-label">Submission Date:</span>
                        <span class="success-value" id="submissionDate"></span>
                    </div>
                    <div class="success-item">
                        <span class="success-label">PDF Generated:</span>
                        <span class="success-value">✅ Yes</span>
                    </div>
                    <div class="success-item">
                        <span class="success-label">Files Uploaded:</span>
                        <span class="success-value">✅ Yes</span>
                    </div>
                </div>
                <div class="success-note">
                    <p><strong>Next Steps:</strong></p>
                    <ul>
                        <li>Your form has been submitted to the system</li>
                        <li>A PDF copy has been generated with your digital signature</li>
                        <li>All attachments have been uploaded successfully</li>
                        <li>You will receive a confirmation email shortly</li>
                    </ul>
                </div>
                <div class="success-actions">
                    <button onclick="window.location.reload()" class="btn-secondary">Submit Another Form</button>
                    <button onclick="window.print()" class="btn-primary">Print Confirmation</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
